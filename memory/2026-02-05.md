# 2026-02-05 記憶

## 新 Agent 設置要求

（已確認：本次 stardew-wiki sub agent 成功跑 Docker sandbox skill；後續 SOP 已整理到 main-agent/MEMORY.md + SOP-subagents.md）

當創建新 agent 時，必須確認以下 Telegram 設置選項：

### 核心設置
1. **Bot Token**（必須）
- 每個 agent 需要自己的 Telegram bot token
- 通過 @BotFather 創建新 bot
- 在 config 中設置 channels.telegram.botToken

2. **訪問控制**
- dmPolicy：私訊訪問策略（pairing / allowlist / open / disabled）
- allowFrom：允許的用戶 ID 列表
- groupPolicy：群組訪問策略（open / allowlist / disabled）
- groupAllowFrom：群組發送者白名單

3. **群組配置**
- groups：配置特定群組的行為
  - requireMention：是否需要 @提及（默認 true）
  - skills：技能過濾器
  - systemPrompt：群組額外的系統提示
  - enabled：啟用/禁用

4. **功能開置**
- capabilities.inlineButtons：內聯按鈕（off / dm / group / all / allowlist）
- reactionNotifications：反應通知（off / own / all）
- reactionLevel：agent 反應能力（off / ack / minimal / extensive）
- actions：各種動作的權限控制

5. **多賬戶支持**（可選）
- 使用 channels.telegram.accounts 為每個 agent 配置獨立賬號
- 每個賬號有自己的 botToken 和配置

## 其他重要信息

- 用戶偏好：使用繁體中文溝通
- Main agent 角色：管理其他 agent
- 其他 agent 有獨立的 workspace
- 各 agent 在獨立的 Telegram 群組，session 和 memory 互不干擾

## ⚠️ 重要錯誤教訓：Stardew Valley Wiki Agent 設置事故

### 錯誤描述
在設置 Stardew Valley Wiki agent 時，犯了一個重大錯誤：
- 在 server exec 命令中把 `/Users/admin/.openclaw/workspaces/` 的內容全部刪除了
- 結果只剩下新的 `/Users/admin/.openclaw/workspaces/stardew-wiki-agent`

### 正確的架構
- **Main agent workspace**: `/Users/admin/.openclaw/workspace/main-agent`（注意是單數 workspace）
- **Stardew Wiki agent workspace**: `/Users/admin/.openclaw/workspaces/stardew-wiki-agent`（注意是複數 workspaces）
- **關鍵區別**: 注意 workspace vs workspaces 路徑的區別

### Stardew Wiki Agent 配置要點
1. **Telegram 群組**: 綁定到群組 ID: -5281253170（5281253170）
2. **System Prompt**: 嚴格限制只能使用 Stardew Valley Wiki skill 回答問題，絕對不能做其他操作
3. **工具限制**（tools.deny）:
   - exec
   - process
   - browser
   - write
   - edit
   - apply_patch
   - web_search
   - web_fetch
   - canvas
   - nodes
   - cron
4. **Sandbox 設置**:
   - mode: "all"
   - workspaceAccess: "ro"
   - scope: "agent"

### ⚠️ 未來規則
**新增 agent 時必須遵守：**
1. 絕對不能影響或修改 main agent 的配置
2. 確保 workspace 路徑正確（注意單複數區別）
3. 如果 agent 有專門用途，必須設置嚴格的 system prompt 和工具限制
4. 任何涉及刪除文件系統內容的操作必須極度謹慎
